import './polyfills.server.mjs';
import{a as P}from"./chunk-QCLZVWPK.mjs";import{b as t,d as F,f as S,h as C,i as x,k as E}from"./chunk-R3W2DALW.mjs";import{a as I}from"./chunk-4KER3KLO.mjs";import{d as y}from"./chunk-I4XGKXLL.mjs";import{D as w}from"./chunk-ZQCBKITM.mjs";import"./chunk-5UF2B2WO.mjs";import{$a as c,Ib as h,Kb as b,Qa as r,Vb as m,W as l,Wb as v,a as d,pb as g,qb as f,ub as o,vb as n,wb as s,xb as u}from"./chunk-E5AJEFIA.mjs";import"./chunk-X2SEQXRR.mjs";function _(p,e){if(p&1&&(n(0,"div",5)(1,"ul",6)(2,"li"),m(3),s()()()),p&2){let a=b();r(3),v(a.msgError)}}var R=class p{authService=l(I);router=l(y);fb=l(x);cookieService=l(w);subscription=new d;flagPassword=!0;flagrePassword=!0;msgError="";registerForm;ngOnInit(){this.initForm()}initForm(){this.registerForm=this.fb.group({name:[null,[t.required,t.minLength(3),t.maxLength(20)]],email:[null,[t.required,t.email]],password:[null,[t.required,t.pattern(/^\w{6,}$/)]],rePassword:[null,[t.required,t.pattern(/^\w{6,}$/)]],phone:[null,[t.required,t.pattern(/^01[0125][0-9]{8}$/)]]},{validators:this.confirmPassword})}confirmPassword(e){return e.get("password")?.value===e.get("rePassword")?.value?null:(e.get("rePassword")?.setErrors({mismatch:!0}),{mismatch:!0})}submitForm(){this.registerForm.valid?this.subscription=this.authService.registerForm(this.registerForm.value).subscribe({next:e=>{console.log(e),e.message==="success"&&(this.msgError="",setTimeout(()=>{this.cookieService.set("token",e.token),this.router.navigate(["/login"])},1e3))},error:e=>{console.log(e),this.msgError=e.error.message}}):(this.registerForm.setErrors({mismatch:!0}),this.registerForm.markAllAsTouched())}static \u0275fac=function(a){return new(a||p)};static \u0275cmp=c({type:p,selectors:[["app-register"]],decls:14,vars:22,consts:[[1,"bg-gray-100","border","border-gray-200","p-4","shadow-md","md:w-1/2","mx-auto","my-14","rounded-lg"],[1,"text-center","mb-5","font-light","text-3xl"],[3,"ngSubmit","formGroup"],[3,"control","typeInput","idInput","labelInput"],[1,"btn","w-full","mt-4","p-3"],["role","alert",1,"flex","mt-4","p-4","mb-4","text-sm","text-red-800","rounded-lg","bg-red-300","dark:bg-gray-800","dark:text-red-400","justify-center"],[1,"mt-1.5","list-disc","list-inside"]],template:function(a,i){a&1&&(n(0,"section",0)(1,"h1",1),m(2,"Register Now"),s(),n(3,"form",2),h("ngSubmit",function(){return i.submitForm()}),u(4,"app-input",3)(5,"app-input",3),n(6,"app-input",3),m(7," custom field should match the pattern [should more than or equal 6] "),s(),u(8,"app-input",3),n(9,"app-input",3),m(10," Accept only egypt phone numbers "),s(),n(11,"button",4),m(12,"Register"),s(),g(13,_,4,1,"div",5),s()()),a&2&&(r(3),o("formGroup",i.registerForm),r(),o("control",i.registerForm.get("name"))("typeInput","text")("idInput","name")("labelInput","Name"),r(),o("control",i.registerForm.get("email"))("typeInput","email")("idInput","email")("labelInput","Email"),r(),o("control",i.registerForm.get("password"))("typeInput","password")("idInput","password")("labelInput","Password"),r(2),o("control",i.registerForm.get("rePassword"))("typeInput","password")("idInput","rePassword")("labelInput","RePassword"),r(),o("control",i.registerForm.get("phone"))("typeInput","tel")("idInput","phone")("labelInput","Phone"),r(4),f(i.msgError?13:-1))},dependencies:[E,S,F,C,P],encapsulation:2})};export{R as RegisterComponent};
